# BGP. Фильтрация
`Цель:`
Настроить фильтрацию для офисе Москва
Настроить фильтрацию для офисе С.-Петербург

# Задание:
- `Часть1.` Настроить фильтрацию в офисе Москва так, чтобы не появилось транзитного трафика(As-path).
- `Часть2.` Настроить фильтрацию в офисе С.-Петербург так, чтобы не появилось транзитного трафика(Prefix-list).
- `Часть3.` Настроить провайдера Киторн так, чтобы в офис Москва отдавался только маршрут по умолчанию.
- `Часть4.` Настроить провайдера Ламас так, чтобы в офис Москва отдавался только маршрут по умолчанию и префикс офиса С.-Петербург.
- `Часть5.` Все сети в лабораторной работе должны иметь IP связность.

## Устранение транзитного трафика
Существует два основных способа фильтрации транзитного трафика:
  * когда мы не являемся транзитной зоной АС (фильтрация по as-path)
  * когда мы являемся транзитной зоной АС (фильтрация по набору префиксов)

## Устраняем транзитный трафик в Москве

По сути у нас нет транзитного трафика, т.к. офис Москва является конечной АС. Тем не менее настроим фильтрацию транзитного трафика на случай появления нового офиса, подключенного через офис Москва:
~~~
R15(config)#ip as-path access-list 1 permit ^$
R15(config)#ip as-path access-list 1 deny .*
R15(config)#router bgp 1001
R15(config-router)#neighbor 10.8.0.1 filter-list 1 out
~~~
## Устраним транзитный трафик в Санкт-Петербурге
Тут так же нет транзитного трафика. Сделаем разрешение на трансляцию только клиентских сетей:
~~~
R18(config)#ip prefix-list NO-TRANSIT seq 5 permit 192.168.4.0/24
R18(config)#ip prefix-list NO-TRANSIT seq 10 permit 192.168.5.0/24
R18(config)#router bgp 2042
R18(config-router)#neighbor 10.0.4.1 prefix-list NO-TRANSIT out
R18(config-router)#neighbor 10.0.2.1 prefix-list NO-TRANSIT out
~~~
